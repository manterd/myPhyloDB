{% extends 'base.html' %}
{% load static %}

{% block pagetitle %}
    <title xmlns="http://www.w3.org/1999/html">Select</title>
{% endblock pagetitle %}

{% block javascript %}
    <script type="text/javascript">
        var selKeys = "";

        $(function () {
            $("#tabs").tabs({
                "activate": function(event, ui) {
                    var table = $.fn.dataTable.fnTables(true);
                    if ( table.length > 0 ) {
                        $(table).dataTable().fnAdjustColumnSizing();
                        var oTableTools = TableTools.fnGetInstance(table[0]);
                        if (oTableTools != null && oTableTools.fnResizeRequired()) {
                            oTableTools.fnResizeButtons();
                        }
                    }
                }
            });

            $(".display").dataTable({
                "jQueryUI": true,
                "sDom": 'T<"clear">lfrtip',
                "oTableTools": {
                    "sSwfPath": "{% static "tabletools/swf/copy_csv_xls_pdf.swf" %}"
                },
                "bSort": true,
                "scrollX": true
            });

            $("#tree").dynatree({
                checkbox: true,
                selectMode: 3,
                initAjax: {
                    url: "/getProjectTree/",
                    dataType: "jsonp",
                    data: {}
                },
                onLazyRead: function (node) {
                    node.appendAjax({
                        url: '/getProjectTreeChildren/',
                        data: {id: node.data.id}
                    });
                },
                onSelect: function (flag, node) {
                   if (flag && node.childList == undefined) {
                        node.reloadChildren(function () {
                            node.select(false);
                            node.select(true);
                        });
                    }
                }
            });

            $("#drawtable").click(function () {
                selKeys = $.map($("#tree").dynatree("getSelectedNodes"), function(node) {
                    return node.data.id;
                });
                updateNodes(selKeys);
            });

            $("#clearMeta").click(function(){
                $("#tree").dynatree("getRoot").visit(function (node) {
                    node.select(false);
                });
                updateNodes();
            });

            $("#submit").click(function () {
                selKeys = $.map($("#tree").dynatree("getSelectedNodes"), function(node) {
                    return node.data.id;
                });
                var jsonDict = JSON.stringify(selKeys);
                $.ajax({
                    type: 'GET',
                    url: '/saveCookie/',
                    dataType: 'json',
                    data: {all: jsonDict},
                    success: function(data) {
                        var result = JSON.stringify(data);
                        alert(result);
                        $("#link0").show();
                        $("#link1").show();
                        $("#link2").show();
                        $("#link3").show();
                        $("#link4").show();
                    }
                });
            });
        });

        function updateNodes(selKeys) {
            updateProjectTable(selKeys);
            updateSampleTable(selKeys);

            var pTypes = new Array(0);

            $.each(selKeys, function (index, value) {
                {% for project in projects %}
                    var id = "{{ project.projectid }}";
                    if (id == value) {
                        var element = "{{ project.projectType }}";
                        pTypes.push(element);
                    }
                {% endfor %}
            });

            if (pTypes.indexOf("soil")>-1) {
                updateSoilTable(selKeys);
                $("#soil").show();
            } else {
                $("#soil").hide();
            }
            if (pTypes.indexOf("human_gut")>-1) {
                updateGutTable(selKeys);
                $("#humgut").show();
            } else {
                $("#humgut").hide();
            }
            if (pTypes.indexOf("human_associated")>-1) {
                updateAssociatedTable(selKeys);
                $("#humasso").show();
            } else {
                $("#humasso").hide();
            }
            if (pTypes.indexOf("microbial")>-1) {
                updateMicrobialTable(selKeys);
                $("#microbial").show();
            } else {
                $("#microbial").hide();
            }
            if (pTypes.indexOf("water")>-1) {
                updateWaterTable(selKeys);
                $("#water").show();
            } else {
                $("#water").hide();
            }
            if (pTypes.indexOf("air")>-1) {
                updateAirTable(selKeys);
                $("#air").show();
            } else {
                $("#air").hide();
            }

            updateUsrTable(selKeys);
        }

        function updateProjectTable(selKeys) {
            var table = $('#projectTable').DataTable();
            table.rows().remove().draw();
            $.each(selKeys, function (index, value) {
                {% for project in projects %}
                    {% for sample in project.sample_set.all %}
                        var id = "{{ sample.sampleid }}";
                        if (id == value) {
                             table.row.add([
                                "{{ project.project_name }}",
                                "{{ project.projectid }}",
                                "{{ sample.sample_name }}",
                                "{{ project.project_desc }}",
                                "{{ project.start_date }}",
                                "{{ project.end_date }}",
                                "{{ project.pi_last }}",
                                "{{ project.pi_first }}",
                                "{{ project.pi_affiliation }}",
                                "{{ project.pi_email }}",
                                "{{ project.pi_phone }}"
                             ]).draw();
                        }
                    {% endfor %}
                {% endfor %}
            });
        }

        function updateSampleTable(selKeys) {
            var table = $('#sampleTable').DataTable();
            table.rows().remove().draw();
            $.each(selKeys, function (index, value) {
                {% for project in projects %}
                    {% for sample in project.sample_set.all %}
                        var id = "{{ sample.sampleid }}";
                        if (id == value) {
                             table.row.add([
                                "{{ project.project_name }}",
                                "{{ sample.sampleid }}",
                                "{{ sample.sample_name }}",
                                "{{ sample.organism }}",
                                "{{ sample.title }}",
                                "{{ sample.seq_method }}",
                                "{{ sample.collection_date }}",
                                "{{ sample.biome }}",
                                "{{ sample.feature }}",
                                "{{ sample.geo_loc_country }}",
                                "{{ sample.geo_loc_state }}",
                                "{{ sample.geo_loc_city }}",
                                "{{ sample.geo_loc_farm }}",
                                "{{ sample.geo_loc_plot }}",
                                "{{ sample.material }}",
                                "{{ sample.latitude }}",
                                "{{ sample.longitude }}",
                                "{{ sample.elevation }}"
                             ]).draw();
                        }
                    {% endfor %}
                {% endfor %}
            });
        }

        function updateWaterTable(selKeys) {
            var table = $('#waterTable').DataTable();
            table.rows().remove().draw();
            $.each(selKeys, function (index, value) {
                    {% for project in projects %}
                        {% for Water in project.water_set.all %}
                            var id = "{{ Water.sampleid.sampleid }}";
                            if (id == value) {
                                 table.row.add([
                                     "{{ project.project_name }}",
                                     "{{ Water.sampleid.sample_name }}",
                                     "{{ Water.alkalinity }}",
                                     "{{ Water.alkyl_diethers }}",
                                     "{{ Water.altitude }}",
                                     "{{ Water.aminopept_act }}",
                                     "{{ Water.ammonium }}",
                                     "{{ Water.atmospheric_data }}",
                                     "{{ Water.bac_prod }}",
                                     "{{ Water.bac_resp }}",
                                     "{{ Water.bacteria_carb_prod }}",
                                     "{{ Water.biomass }}",
                                     "{{ Water.bishomohopanol }}",
                                     "{{ Water.bromide }}",
                                     "{{ Water.calcium }}",
                                     "{{ Water.carb_nitro_ratio }}",
                                     "{{ Water.chem_administration }}",
                                     "{{ Water.chloride }}",
                                     "{{ Water.chlorophyll }}",
                                     "{{ Water.conduc }}",
                                     "{{ Water.density }}",
                                     "{{ Water.diether_lipids }}",
                                     "{{ Water.diss_carb_dioxide }}",
                                     "{{ Water.diss_hydrogen }}",
                                     "{{ Water.diss_inorg_carb }}",
                                     "{{ Water.diss_inorg_nitro }}",
                                     "{{ Water.diss_inorg_phosp }}",
                                     "{{ Water.diss_org_carb }}",
                                     "{{ Water.diss_org_nitro }}",
                                     "{{ Water.diss_oxygen }}",
                                     "{{ Water.down_par }}",
                                     "{{ Water.elev }}",
                                     "{{ Water.fluor }}",
                                     "{{ Water.glucosidase_act }}",
                                     "{{ Water.light_intensity }}",
                                     "{{ Water.magnesium }}",
                                     "{{ Water.mean_frict_vel }}",
                                     "{{ Water.mean_peak_frict_vel }}",
                                     "{{ Water.n_alkanes }}",
                                     "{{ Water.nitrate }}",
                                     "{{ Water.nitrite }}",
                                     "{{ Water.nitro }}",
                                     "{{ Water.org_carb }}",
                                     "{{ Water.org_matter }}",
                                     "{{ Water.org_nitro }}",
                                     "{{ Water.organism_count }}",
                                     "{{ Water.oxy_stat_samp }}",
                                     "{{ Water.part_org_carb }}",
                                     "{{ Water.part_org_nitro }}",
                                     "{{ Water.perturbation }}",
                                     "{{ Water.petroleum_hydrocarb }}",
                                     "{{ Water.ph }}",
                                     "{{ Water.phaeopigments }}",
                                     "{{ Water.phosphate }}",
                                     "{{ Water.phosplipid_fatt_acid }}",
                                     "{{ Water.photon_flux }}",
                                     "{{ Water.potassium }}",
                                     "{{ Water.pressure }}",
                                     "{{ Water.primary_prod }}",
                                     "{{ Water.redox_potential }}",
                                     "{{ Water.rel_to_oxygen }}",
                                     "{{ Water.samp_mat_process }}",
                                     "{{ Water.samp_salinity }}",
                                     "{{ Water.samp_size }}",
                                     "{{ Water.samp_store_dur }}",
                                     "{{ Water.samp_store_loc }}",
                                     "{{ Water.samp_store_temp }}",
                                     "{{ Water.samp_vold_we_dna_ext }}",
                                     "{{ Water.silicate }}",
                                     "{{ Water.sodium }}",
                                     "{{ Water.soluble_react_phosp }}",
                                     "{{ Water.source_material_id }}",
                                     "{{ Water.sulfate }}",
                                     "{{ Water.sulfide }}",
                                     "{{ Water.suspend_part_matter }}",
                                     "{{ Water.temp }}",
                                     "{{ Water.tidal_stage }}",
                                     "{{ Water.tot_depth_water_col }}",
                                     "{{ Water.tot_diss_nitro }}",
                                     "{{ Water.tot_inorg_nitro }}",
                                     "{{ Water.tot_nitro }}",
                                     "{{ Water.tot_part_carb }}",
                                     "{{ Water.tot_phosp }}",
                                     "{{ Water.water_current }}",
                                     "{{ Water.user_defined }}"
                                 ]).draw();
                            }
                        {% endfor %}
                    {% endfor %}
            });
        }

        function updateAirTable(selKeys) {
            var table = $('#airTable').DataTable();
            table.rows().remove().draw();
            $.each(selKeys, function (index, value) {
                    {% for project in projects %}
                        {% for Air in project.air_set.all %}
                            var id = "{{ Air.sampleid.sampleid }}";
                            if (id == value) {
                                 table.row.add([
                                    "{{ project.project_name }}",
                                    "{{ Air.sampleid.sample_name }}",
                                    "{{ Air.barometric_press }}",
                                    "{{ Air.carb_dioxide }}",
                                    "{{ Air.carb_monoxide }}",
                                    "{{ Air.chem_administration }}",
                                    "{{ Air.elev }}",
                                    "{{ Air.humidity }}",
                                    "{{ Air.methane }}",
                                    "{{ Air.organism_count }}",
                                    "{{ Air.oxy_stat_samp }}",
                                    "{{ Air.oxygen }}",
                                    "{{ Air.perturbation }}",
                                    "{{ Air.pollutants }}",
                                    "{{ Air.rel_to_oxygen }}",
                                    "{{ Air.resp_part_matter }}",
                                    "{{ Air.samp_collect_device }}",
                                    "{{ Air.samp_mat_process }}",
                                    "{{ Air.samp_salinity }}",
                                    "{{ Air.samp_size }}",
                                    "{{ Air.samp_store_dur }}",
                                    "{{ Air.samp_store_loc }}",
                                    "{{ Air.samp_store_temp }}",
                                    "{{ Air.solar_irradiance }}",
                                    "{{ Air.temp }}",
                                    "{{ Air.ventilation_rate }}",
                                    "{{ Air.ventilation_type }}",
                                    "{{ Air.volatile_org_comp }}",
                                    "{{ Air.wind_direction }}",
                                    "{{ Air.wind_speed }}",
                                    "{{ Air.user_defined }}"
                                 ]).draw();
                            }
                        {% endfor %}
                    {% endfor %}
            });
        }

        function updateAssociatedTable(selKeys) {
            var table = $('#humassoTable').DataTable();
            table.rows().remove().draw();
            $.each(selKeys, function (index, value) {
                    {% for project in projects %}
                        {% for Human_Associated in project.human_associated_set.all %}
                            var id = "{{ Human_Associated.sampleid.sampleid }}";
                            if (id == value) {
                                 table.row.add([
                                    "{{ project.project_name }}",
                                    "{{ Human_Associated.sampleid.sample_name }}",
                                    "{{ Human_Associated.age }}",
                                    "{{ Human_Associated.amniotic_fluid_color }}",
                                    "{{ Human_Associated.blood_blood_disord }}",
                                    "{{ Human_Associated.body_mass_index }}",
                                    "{{ Human_Associated.body_product }}",
                                    "{{ Human_Associated.chem_administration }}",
                                    "{{ Human_Associated.diet }}",
                                    "{{ Human_Associated.diet_last_six_month }}",
                                    "{{ Human_Associated.disease }}",
                                    "{{ Human_Associated.drug_usage }}",
                                    "{{ Human_Associated.ethnicity }}",
                                    "{{ Human_Associated.family_relationship }}",
                                    "{{ Human_Associated.fetal_health_stat }}",
                                    "{{ Human_Associated.genotype }}",
                                    "{{ Human_Associated.gestation_state }}",
                                    "{{ Human_Associated.height }}",
                                    "{{ Human_Associated.hiv_stat }}",
                                    "{{ Human_Associated.host_body_temp }}",
                                    "{{ Human_Associated.host_subject_id }}",
                                    "{{ Human_Associated.ihmc_medication_code }}",
                                    "{{ Human_Associated.kidney_disord }}",
                                    "{{ Human_Associated.last_meal }}",
                                    "{{ Human_Associated.maternal_health_stat }}",
                                    "{{ Human_Associated.medic_hist_perform }}",
                                    "{{ Human_Associated.nose_throat_disord }}",
                                    "{{ Human_Associated.occupation }}",
                                    "{{ Human_Associated.organism_count }}",
                                    "{{ Human_Associated.oxy_stat_samp }}",
                                    "{{ Human_Associated.perturbation }}",
                                    "{{ Human_Associated.pet_farm_animal }}",
                                    "{{ Human_Associated.phenotype }}",
                                    "{{ Human_Associated.pulmonary_disord }}",
                                    "{{ Human_Associated.pulse }}",
                                    "{{ Human_Associated.rel_to_oxygen }}",
                                    "{{ Human_Associated.samp_collect_device }}",
                                    "{{ Human_Associated.samp_mat_proecess }}",
                                    "{{ Human_Associated.samp_salinity }}",
                                    "{{ Human_Associated.samp_size }}",
                                    "{{ Human_Associated.samp_store_dur }}",
                                    "{{ Human_Associated.samp_store_loc }}",
                                    "{{ Human_Associated.samp_store_temp }}",
                                    "{{ Human_Associated.sex }}",
                                    "{{ Human_Associated.smoker }}",
                                    "{{ Human_Associated.study_complt_stat }}",
                                    "{{ Human_Associated.temp }}",
                                    "{{ Human_Associated.tissue }}",
                                    "{{ Human_Associated.tot_mass }}",
                                    "{{ Human_Associated.travel_out_six_month }}",
                                    "{{ Human_Associated.twin_sibling }}",
                                    "{{ Human_Associated.urine_collect_meth }}",
                                    "{{ Human_Associated.urogenit_tract_disor }}",
                                    "{{ Human_Associated.weight_loss_3_month }}",
                                    "{{ Human_Associated.user_defined }}"
                                 ]).draw();
                            }
                        {% endfor %}
                    {% endfor %}
            });
        }

        function updateGutTable(selKeys){
           var table = $('#human_gutTable').DataTable();
            table.rows().remove().draw();
            $.each(selKeys, function (index, value) {
                    {% for project in projects %}
                        {% for Human_Gut in project.human_gut_set.all %}
                            var id = "{{ Human_gut.sampleid.sampleid }}";
                            if (id == value) {
                                 table.row.add([
                                    "{{ project.project_name }}",
                                    "{{ Human_Gut.sampleid.sample_name }}",
                                    "{{ Human_Gut.age }}",
                                    "{{ Human_Gut.body_mass_index }}",
                                    "{{ Human_Gut.body_product }}",
                                    "{{ Human_Gut.chem_administration }}",
                                    "{{ Human_Gut.diet }}",
                                    "{{ Human_Gut.disease }}",
                                    "{{ Human_Gut.ethnicity }}",
                                    "{{ Human_Gut.family_relationship }}",
                                    "{{ Human_Gut.gastrointest_disord }}",
                                    "{{ Human_Gut.genotype }}",
                                    "{{ Human_Gut.height }}",
                                    "{{ Human_Gut.host_body_temp }}",
                                    "{{ Human_Gut.host_subject_id }}",
                                    "{{ Human_Gut.ihmc_medication_code }}",
                                    "{{ Human_Gut.last_meal }}",
                                    "{{ Human_Gut.liver_disord }}",
                                    "{{ Human_Gut.medic_hist_perform }}",
                                    "{{ Human_Gut.nose_throat_disord }}",
                                    "{{ Human_Gut.occupation }}",
                                    "{{ Human_Gut.organism_count }}",
                                    "{{ Human_Gut.oxy_stat_samp }}",
                                    "{{ Human_Gut.perturbation }}",
                                    "{{ Human_Gut.phenotype }}",
                                    "{{ Human_Gut.pulse }}",
                                    "{{ Human_Gut.rel_to_oxygen }}",
                                    "{{ Human_Gut.samp_collect_device }}",
                                    "{{ Human_Gut.samp_mat_process }}",
                                    "{{ Human_Gut.samp_salinity }}",
                                    "{{ Human_Gut.samp_size }}",
                                    "{{ Human_Gut.samp_store_dur }}",
                                    "{{ Human_Gut.samp_store_loc }}",
                                    "{{ Human_Gut.samp_store_temp }}",
                                    "{{ Human_Gut.sex }}",
                                    "{{ Human_Gut.special_diet }}",
                                    "{{ Human_Gut.temp }}",
                                    "{{ Human_Gut.tissue }}",
                                    "{{ Human_Gut.tot_mass }}",
                                    "{{ Human_Gut.user_defined }}"
                                 ]).draw();
                            }
                        {% endfor %}
                    {% endfor %}
            });
        }

        function updateMicrobialTable(selKeys){
           var table = $('#microbialTable').DataTable();
            table.rows().remove().draw();
            $.each(selKeys, function (index, value) {
                    {% for project in projects %}
                        {% for Microbial in project.microbial_set.all %}
                            var id = "{{ Microbial.sampleid.sampleid }}";
                            if (id == value) {
                                 table.row.add([
                                    "{{ project.project_name }}",
                                    "{{ Microbial.sampleid.sample_name }}",
                                    "{{ Microbial.alkalinity }}",
                                    "{{ Microbial.alkyl_diethers }}",
                                    "{{ Microbial.altitude }}",
                                    "{{ Microbial.aminopept_act }}",
                                    "{{ Microbial.ammonium }}",
                                    "{{ Microbial.bacteria_carb_prod }}",
                                    "{{ Microbial.biomass }}",
                                    "{{ Microbial.bishomohopanol }}",
                                    "{{ Microbial.bromide }}",
                                    "{{ Microbial.calcium }}",
                                    "{{ Microbial.carb_nitro_ratio }}",
                                    "{{ Microbial.chem_administration }}",
                                    "{{ Microbial.chloride }}",
                                    "{{ Microbial.chlorophyll }}",
                                    "{{ Microbial.diether_lipids }}",
                                    "{{ Microbial.diss_carb_dioxide }}",
                                    "{{ Microbial.diss_hydrogen }}",
                                    "{{ Microbial.diss_inorg_carb }}",
                                    "{{ Microbial.diss_org_carb }}",
                                    "{{ Microbial.diss_org_nitro }}",
                                    "{{ Microbial.diss_oxygen }}",
                                    "{{ Microbial.glucosidase_act }}",
                                    "{{ Microbial.magnesium }}",
                                    "{{ Microbial.mean_frict_vel }}",
                                    "{{ Microbial.mean_peak_frict_vel }}",
                                    "{{ Microbial.methane }}",
                                    "{{ Microbial.n_alkanes }}",
                                    "{{ Microbial.nitrate }}",
                                    "{{ Microbial.nitrite }}",
                                    "{{ Microbial.nitro }}",
                                    "{{ Microbial.org_carb }}",
                                    "{{ Microbial.org_matter }}",
                                    "{{ Microbial.org_nitro }}",
                                    "{{ Microbial.organism_count }}",
                                    "{{ Microbial.oxy_stat_samp }}",
                                    "{{ Microbial.part_org_carb }}",
                                    "{{ Microbial.perturbation }}",
                                    "{{ Microbial.petroleum_hydrocarb }}",
                                    "{{ Microbial.ph }}",
                                    "{{ Microbial.phaeopigments }}",
                                    "{{ Microbial.phosphate }}",
                                    "{{ Microbial.phosplipid_fatt_acid }}",
                                    "{{ Microbial.potassium }}",
                                    "{{ Microbial.pressure }}",
                                    "{{ Microbial.redox_potential }}",
                                    "{{ Microbial.rel_to_oxygen }}",
                                    "{{ Microbial.salinity }}",
                                    "{{ Microbial.samp_collect_device }}",
                                    "{{ Microbial.samp_mat_process }}",
                                    "{{ Microbial.samp_size }}",
                                    "{{ Microbial.samp_store_dur }}",
                                    "{{ Microbial.samp_store_loc }}",
                                    "{{ Microbial.samp_store_temp }}",
                                    "{{ Microbial.silicate }}",
                                    "{{ Microbial.sodium }}",
                                    "{{ Microbial.sulfate }}",
                                    "{{ Microbial.sulfide }}",
                                    "{{ Microbial.temp }}",
                                    "{{ Microbial.tot_carb }}",
                                    "{{ Microbial.tot_nitro }}",
                                    "{{ Microbial.tot_org_carb }}",
                                    "{{ Microbial.turbidity }}",
                                    "{{ Microbial.water_content }}",
                                    "{{ Microbial.user_defined }}"
                                 ]).draw();
                            }
                        {% endfor %}
                    {% endfor %}
            });
        }
        function updateSoilTable(selKeys){
            var table = $('#soilTable').DataTable();
            table.rows().remove().draw();
            $.each(selKeys, function (index, value) {
                    {% for project in projects %}
                        {% for Soil in project.soil_set.all %}
                            var id = "{{ Soil.sampleid.sampleid }}";
                            if (id == value) {
                                 table.row.add([
                                    "{{ project.project_name }}",
                                    "{{ Soil.sampleid.sample_name }}",
                                    "{{ Soil.depth }}",
                                    "{{ Soil.pool_dna_extracts }}",
                                    "{{ Soil.samp_size }}",
                                    "{{ Soil.samp_collection_device }}",
                                    "{{ Soil.samp_weight_dna_ext }}",
                                    "{{ Soil.sieving }}",
                                    "{{ Soil.storage_cond }}",
                                    "{{ Soil.annual_season_precpt }}",
                                    "{{ Soil.annual_season_temp }}",
                                    "{{ Soil.bulk_density }}",
                                    "{{ Soil.drainage_class }}",
                                    "{{ Soil.fao_class }}",
                                    "{{ Soil.horizon }}",
                                    "{{ Soil.local_class }}",
                                    "{{ Soil.porosity }}",
                                    "{{ Soil.profile_position }}",
                                    "{{ Soil.slope_aspect }}",
                                    "{{ Soil.slope_gradient }}",
                                    "{{ Soil.soil_type }}",
                                    "{{ Soil.texture_class }}",
                                    "{{ Soil.water_content_soil }}",
                                    "{{ Soil.pH }}",
                                    "{{ Soil.EC }}",
                                    "{{ Soil.tot_C }}",
                                    "{{ Soil.tot_OM }}",
                                    "{{ Soil.tot_N }}",
                                    "{{ Soil.NO3_N }}",
                                    "{{ Soil.NH4_N }}",
                                    "{{ Soil.P }}",
                                    "{{ Soil.K }}",
                                    "{{ Soil.S }}",
                                    "{{ Soil.Zn }}",
                                    "{{ Soil.Fe }}",
                                    "{{ Soil.Cu }}",
                                    "{{ Soil.Mn }}",
                                    "{{ Soil.Ca }}",
                                    "{{ Soil.Mg }}",
                                    "{{ Soil.Na }}",
                                    "{{ Soil.B }}",
                                    "{{ Soil.agrochem_amendments }}",
                                    "{{ Soil.agrochem_amendments_desc }}",
                                    "{{ Soil.biological_amendments }}",
                                    "{{ Soil.biological_amendments_desc }}",
                                    "{{ Soil.cover_crop }}",
                                    "{{ Soil.crop_rotation }}",
                                    "{{ Soil.cur_land_use }}",
                                    "{{ Soil.cur_vegetation }}",
                                    "{{ Soil.cur_crop }}",
                                    "{{ Soil.cur_cultivar }}",
                                    "{{ Soil.organic }}",
                                    "{{ Soil.previous_land_use }}",
                                    "{{ Soil.soil_amendments }}",
                                    "{{ Soil.soil_amendments_desc }}",
                                    "{{ Soil.tillage }}",
                                    "{{ Soil.rRNA_copies }}",
                                    "{{ Soil.microbial_biomass_C }}",
                                    "{{ Soil.microbial_biomass_N }}",
                                    "{{ Soil.microbial_respiration }}"
                                 ]).draw();
                            }
                        {% endfor %}
                    {% endfor %}
            });
        }

        function updateUsrTable(selKeys) {
            var table = $('#usrTable').DataTable();
            table.rows().remove().draw();
            $.each(selKeys, function (index, value) {
                    {% for project in projects %}
                        {% for User in project.user_set.all %}
                            var id = "{{ User.sampleid.sampleid }}";
                            if (id == value) {
                                 table.row.add([
                                    "{{ project.project_name }}",
                                    "{{ User.sampleid.sample_name }}",
                                    "{{ User.usr_cat1 }}",
                                    "{{ User.usr_cat2 }}",
                                    "{{ User.usr_cat3 }}",
                                    "{{ User.usr_cat4 }}",
                                    "{{ User.usr_cat5 }}",
                                    "{{ User.usr_cat6 }}",
                                    "{{ User.usr_quant1 }}",
                                    "{{ User.usr_quant2 }}",
                                    "{{ User.usr_quant3 }}",
                                    "{{ User.usr_quant4 }}",
                                    "{{ User.usr_quant5 }}",
                                    "{{ User.usr_quant6 }}"
                                 ]).draw();
                            }
                        {% endfor %}
                    {% endfor %}
            });
        }
    </script>
{% endblock javascript %}

{% block my_content %}
    <br>
    <table border="2" cellspacing="0" cellpadding="5">
        <tr>
            <th>Select any combination of data for analysis:<br><a href="#" id="clearMeta" style="font-size: 12px;">-Deselect all-</a></th>
        </tr>
        <tr>
            <td style="padding-right: 10px; vertical-align: top">
                <div id="tree"></div>
            </td>
        </tr>
    </table>

    <br>
    <input id="submit" type="button" value="Save Selection(s)!"/>
    <br><br><br>
    <h2>Project/Sample information for selected samples</h2>
    <input id="drawtable" type="button" value="Show Selection(s) in DataTable!"/>
    <br><br>

    <div id="demo" style="width: 1000px">
        <div id="tabs">
            <ul>
                <li><a href="#tabs-1" style="font-size: 14px">Project</a></li>
                <li><a href="#tabs-2" style="font-size: 14px">MIMARKs</a></li>
                <li><a href="#tabs-soil" style="font-size: 14px; display: none" id="soil">Soil</a></li>
                <li><a href="#tabs-10" style="font-size: 14px; display: none" id="humgut">Human Gut</a></li>
                <li><a href="#tabs-air" style="font-size: 14px; display: none" id="air">Air</a></li>
                <li><a href="#tabs-water" style="font-size: 14px; display: none" id="water">Water</a></li>
                <li><a href="#tabs-humasso" style="font-size: 14px; display: none" id="humasso">Human Associated</a></li>
                <li><a href="#tabs-11" style="font-size: 14px; display: none" id="microbial">Microbial</a></li>
                <li><a href="#tabs-9" style="font-size: 14px" id="usr">User-defined</a></li>
            </ul>

            <div id="tabs-1">
                <table id="projectTable" cellpadding="0" cellspacing="0" border="0" class="display">
                    <thead>
                        <tr>
                            <th>project_name</th>
                            <th>project_id</th>
                            <th>sample_name</th>
                            <th>project_desc</th>
                            <th>start_date</th>
                            <th>end_date</th>
                            <th>pi_last</th>
                            <th>pi_first</th>
                            <th>pi_affiliation</th>
                            <th>pi_email</th>
                            <th>pi_phone</th>
                        </tr>
                    </thead>
                </table>
            </div>

            <div id="tabs-2">
                <table id="sampleTable" cellpadding="0" cellspacing="0" border="0" class="display">
                    <thead>
                        <tr>
                            <th>project_name</th>
                            <th>sample_id</th>
                            <th>sample_name</th>
                            <th>organism</th>
                            <th>title</th>
                            <th>seq_method</th>
                            <th>collection_date</th>
                            <th>biome</th>
                            <th>feature</th>
                            <th>geo_loc_country</th>
                            <th>geo_loc_state</th>
                            <th>geo_loc_city</th>
                            <th>geo_loc_farm</th>
                            <th>geo_loc_plot</th>
                            <th>material</th>
                            <th>latitude</th>
                            <th>longitude</th>
                            <th>elevation</th>
                        </tr>
                    </thead>
                </table>
            </div>

            <div id="tabs-soil">
                <table id="soilTable" cellpadding="0" cellspacing="0" border="0" class="display">
                    <thead>
                        <tr>
                            <th>project_name</th>
                            <th>sample_name</th>
                            <th>depth</th>
                            <th>pool_dna_extracts</th>
                            <th>sample_size</th>
                            <th>collection_device</th>
                            <th>samp_weight_dna_ext</th>
                            <th>sieving</th>
                            <th>storage_conditions</th>
                            <th>annual_season_precip</th>
                            <th>annual_season_temp</th>
                            <th>bulk_density</th>
                            <th>drainage_class</th>
                            <th>fao_class</th>
                            <th>horizon</th>
                            <th>local_class</th>
                            <th>porosity</th>
                            <th>profile_position</th>
                            <th>slope_aspect</th>
                            <th>slope_gradient</th>
                            <th>soil_type</th>
                            <th>texture_class</th>
                            <th>water_content_soil</th>
                            <th>pH</th>
                            <th>EC</th>
                            <th>tot_C</th>
                            <th>tot_OM</th>
                            <th>tot_N</th>
                            <th>NO3_N</th>
                            <th>NH4_N</th>
                            <th>P</th>
                            <th>K</th>
                            <th>S</th>
                            <th>Zn</th>
                            <th>Fe</th>
                            <th>Cu</th>
                            <th>Mn</th>
                            <th>Ca</th>
                            <th>Mg</th>
                            <th>Na</th>
                            <th>B</th>
                            <th>agrochem_amendments</th>
                            <th>agrochem_amendments_desc</th>
                            <th>biological_amendments</th>
                            <th>biological_amendments_desc</th>
                            <th>cover_crop</th>
                            <th>crop_rotation</th>
                            <th>cur_land_use</th>
                            <th>cur_vegetation</th>
                            <th>cur_crop</th>
                            <th>cur_cultivar</th>
                            <th>organic</th>
                            <th>previous_land_use</th>
                            <th>soil_amendments</th>
                            <th>soil_amendments_desc</th>
                            <th>tillage</th>
                            <th>rRNA_copies</th>
                            <th>microbial_biomass_C</th>
                            <th>microbial_biomass_N</th>
                            <th>microbial_respiration</th>
                        </tr>
                    </thead>
                </table>
            </div>

            <div id="tabs-10">
                <table id="human_gutTable" cellpadding="0" cellspacing="0" border="0" class="display">
                    <thead>
                        <tr>
                            <th>project_name</th>
                            <th>sample_name</th>
                            <th>age</th>
                            <th>body_mass_index</th>
                            <th>body_product</th>
                            <th>chem_administration</th>
                            <th>diet</th>
                            <th>disease</th>
                            <th>ethnicity</th>
                            <th>family_relationship</th>
                            <th>gastrointest_disord</th>
                            <th>genotype</th>
                            <th>height</th>
                            <th>host_body_temp</th>
                            <th>host_subject_id</th>
                            <th>ihmc_medication_code</th>
                            <th>last_meal</th>
                            <th>liver_disord</th>
                            <th>medic_hist_perform</th>
                            <th>nose_throat_disord</th>
                            <th>occupation</th>
                            <th>organism_count</th>
                            <th>oxy_stat_samp</th>
                            <th>perturbation</th>
                            <th>phenotype</th>
                            <th>pulse</th>
                            <th>rel_to_oxygen</th>
                            <th>samp_collect_device</th>
                            <th>samp_mat_process</th>
                            <th>samp_salinity</th>
                            <th>samp_size</th>
                            <th>samp_store_dur</th>
                            <th>samp_store_loc</th>
                            <th>samp_store_temp</th>
                            <th>sex</th>
                            <th>special_diet</th>
                            <th>temp</th>
                            <th>tissue</th>
                            <th>tot_mass</th>
                            <th>user_defined</th>
                        </tr>
                    </thead>
                </table>
            </div>

            <div id="tabs-11">
                <table id="microbialTable" cellpadding="0" cellspacing="0" border="0" class="display">
                    <thead>
                        <tr>
                            <th>project_name</th>
                            <th>sample_name</th>
                            <th>alkalinity</th>
                            <th>alkyl_diethers</th>
                            <th>altitude</th>
                            <th>aminopept_act</th>
                            <th>ammonium</th>
                            <th>bacteria_carb_prod</th>
                            <th>biomass</th>
                            <th>bishomohopanol</th>
                            <th>bromide</th>
                            <th>calcium</th>
                            <th>carb_nitro_ratio</th>
                            <th>chem_administration</th>
                            <th>chloride</th>
                            <th>chlorophyll</th>
                            <th>diether_lipids</th>
                            <th>diss_carb_dioxide</th>
                            <th>diss_hydrogen</th>
                            <th>diss_inorg_carb</th>
                            <th>diss_org_carb</th>
                            <th>diss_org_nitro</th>
                            <th>diss_oxygen</th>
                            <th>glucosidase_act</th>
                            <th>magnesium</th>
                            <th>mean_frict_vel</th>
                            <th>mean_peak_frict_vel</th>
                            <th>methane</th>
                            <th>n_alkanes</th>
                            <th>nitrate</th>
                            <th>nitrite</th>
                            <th>nitro</th>
                            <th>org_carb</th>
                            <th>org_matter</th>
                            <th>org_nitro</th>
                            <th>organism_count</th>
                            <th>oxy_stat_samp</th>
                            <th>part_org_carb</th>
                            <th>perturbation</th>
                            <th>petroleum_hydrocarb</th>
                            <th>ph</th>
                            <th>phaeopigments</th>
                            <th>phosphate</th>
                            <th>phosplipid_fatt_acid</th>
                            <th>potassium</th>
                            <th>pressure</th>
                            <th>redox_potential</th>
                            <th>rel_to_oxygen</th>
                            <th>salinity</th>
                            <th>samp_collect_device</th>
                            <th>samp_mat_process</th>
                            <th>samp_size</th>
                            <th>samp_store_dur</th>
                            <th>samp_store_loc</th>
                            <th>samp_store_temp</th>
                            <th>silicate</th>
                            <th>sodium</th>
                            <th>sulfate</th>
                            <th>sulfide</th>
                            <th>temp</th>
                            <th>tot_carb</th>
                            <th>tot_nitro</th>
                            <th>tot_org_carb</th>
                            <th>turbidity</th>
                            <th>water_content</th>
                            <th>user_defined</th>
                        </tr>
                    </thead>
                </table>
            </div>

            <div id="tabs-humasso">
                <table id="humassoTable" cellpadding="0" cellspacing="0" border="0" class="display">
                    <thead>
                        <tr>
                            <th>project_name</th>
                            <th>sample_name</th>
                            <th>age</th>
                            <th>amniotic_fluid_color</th>
                            <th>blood_blood_disord</th>
                            <th>body_mass_index</th>
                            <th>body_product</th>
                            <th>chem_administration</th>
                            <th>diet</th>
                            <th>diet_last_six_month</th>
                            <th>disease</th>
                            <th>drug_usage</th>
                            <th>ethnicity</th>
                            <th>family_relationship</th>
                            <th>fetal_health_stat</th>
                            <th>genotype</th>
                            <th>gestation_state</th>
                            <th>height</th>
                            <th>hiv_stat</th>
                            <th>host_body_temp</th>
                            <th>host_subject_id</th>
                            <th>ihmc_medication_code</th>
                            <th>kidney_disord</th>
                            <th>last_meal</th>
                            <th>maternal_health_stat</th>
                            <th>medic_hist_perform</th>
                            <th>nose_throat_disord</th>
                            <th>occupation</th>
                            <th>organism_count</th>
                            <th>oxy_stat_samp</th>
                            <th>perturbation</th>
                            <th>pet_farm_animal</th>
                            <th>phenotype</th>
                            <th>pulmonary_disord</th>
                            <th>pulse</th>
                            <th>rel_to_oxygen</th>
                            <th>samp_collect_device</th>
                            <th>samp_mat_proecess</th>
                            <th>samp_salinity</th>
                            <th>samp_size</th>
                            <th>samp_store_dur</th>
                            <th>samp_store_loc</th>
                            <th>samp_store_temp</th>
                            <th>sex</th>
                            <th>smoker</th>
                            <th>study_complt_stat</th>
                            <th>temp</th>
                            <th>tissue</th>
                            <th>tot_mass</th>
                            <th>travel_out_six_month</th>
                            <th>twin_sibling</th>
                            <th>urine_collect_meth</th>
                            <th>urogenit_tract_disor</th>
                            <th>weight_loss_3_month</th>
                            <th>user_defined</th>
                        </tr>
                    </thead>
                </table>
            </div>

            <div id="tabs-water">
                <table id="waterTable" cellpadding="0" cellspacing="0" border="0" class="display">
                    <thead>
                        <tr>
                             <th>project_name</th>
                             <th>sample_name</th>
                             <th>alkalinity</th>
                             <th>alkyl_diethers</th>
                             <th>altitude</th>
                             <th>aminopept_act</th>
                             <th>ammonium</th>
                             <th>atmospheric_data</th>
                             <th>bac_prod</th>
                             <th>bac_resp</th>
                             <th>bacteria_carb_prod</th>
                             <th>biomass</th>
                             <th>bishomohopanol</th>
                             <th>bromide</th>
                             <th>calcium</th>
                             <th>carb_nitro_ratio</th>
                             <th>chem_administration</th>
                             <th>chloride</th>
                             <th>chlorophyll</th>
                             <th>conduc</th>
                             <th>density</th>
                             <th>diether_lipids</th>
                             <th>diss_carb_dioxide</th>
                             <th>diss_hydrogen</th>
                             <th>diss_inorg_carb</th>
                             <th>diss_inorg_nitro</th>
                             <th>diss_inorg_phosp</th>
                             <th>diss_org_carb</th>
                             <th>diss_org_nitro</th>
                             <th>diss_oxygen</th>
                             <th>down_par</th>
                             <th>elev</th>
                             <th>fluor</th>
                             <th>glucosidase_act</th>
                             <th>light_intensity</th>
                             <th>magnesium</th>
                             <th>mean_frict_vel</th>
                             <th>mean_peak_frict_vel</th>
                             <th>n_alkanes</th>
                             <th>nitrate</th>
                             <th>nitrite</th>
                             <th>nitro</th>
                             <th>org_carb</th>
                             <th>org_matter</th>
                             <th>org_nitro</th>
                             <th>organism_count</th>
                             <th>oxy_stat_samp</th>
                             <th>part_org_carb</th>
                             <th>part_org_nitro</th>
                             <th>perturbation</th>
                             <th>petroleum_hydrocarb</th>
                             <th>ph</th>
                             <th>phaeopigments</th>
                             <th>phosphate</th>
                             <th>phosplipid_fatt_acid</th>
                             <th>photon_flux</th>
                             <th>potassium</th>
                             <th>pressure</th>
                             <th>primary_prod</th>
                             <th>redox_potential</th>
                             <th>rel_to_oxygen</th>
                             <th>samp_mat_process</th>
                             <th>samp_salinity</th>
                             <th>samp_size</th>
                             <th>samp_store_dur</th>
                             <th>samp_store_loc</th>
                             <th>samp_store_temp</th>
                             <th>samp_vold_we_dna_ext</th>
                             <th>silicate</th>
                             <th>sodium</th>
                             <th>soluble_react_phosp</th>
                             <th>source_material_id</th>
                             <th>sulfate</th>
                             <th>sulfide</th>
                             <th>suspend_part_matter</th>
                             <th>temp</th>
                             <th>tidal_stage</th>
                             <th>tot_depth_water_col</th>
                             <th>tot_diss_nitro</th>
                             <th>tot_inorg_nitro</th>
                             <th>tot_nitro</th>
                             <th>vtot_part_carb</th>
                             <th>tot_phosp</th>
                             <th>water_current</th>
                             <th>vuser_defined</th>
                        </tr>
                    </thead>
                </table>
            </div>

            <div id="tabs-air">
                <table id="airTable" cellpadding="0" cellspacing="0" border="0" class="display">
                    <thead>
                        <tr>
                            <th>project_name</th>
                            <th>sample_name</th>
                            <th>barometric_press</th>
                            <th>carb_dioxide</th>
                            <th>carb_monoxide</th>
                            <th>chem_administration</th>
                            <th>elev</th>
                            <th>humidity</th>
                            <th>methane</th>
                            <th>organism_count</th>
                            <th>oxy_stat_samp</th>
                            <th>oxygen</th>
                            <th>perturbation</th>
                            <th>pollutants</th>
                            <th>rel_to_oxygen</th>
                            <th>resp_part_matter</th>
                            <th>samp_collect_device</th>
                            <th>samp_mat_process</th>
                            <th>samp_salinity</th>
                            <th>samp_size</th>
                            <th>samp_store_dur</th>
                            <th>samp_store_loc</th>
                            <th>samp_store_temp</th>
                            <th>solar_irradiance</th>
                            <th>temp</th>
                            <th>ventilation_rate</th>
                            <th>ventilation_type</th>
                            <th>volatile_org_comp</th>
                            <th>wind_direction</th>
                            <th>wind_speed</th>
                            <th>user_defined</th>
                        </tr>
                    </thead>
                </table>
            </div>

            <div id="tabs-9">
                <table id="usrTable" cellpadding="0" cellspacing="0" border="0" class="display">
                    <thead>
                        <tr>
                            <th>project_name</th>
                            <th>sample_name</th>
                            <th>usr_cat1</th>
                            <th>usr_cat2</th>
                            <th>usr_cat3</th>
                            <th>usr_cat4</th>
                            <th>usr_cat5</th>
                            <th>usr_cat6</th>
                            <th>usr_quant1</th>
                            <th>usr_quant2</th>
                            <th>usr_quant3</th>
                            <th>usr_quant4</th>
                            <th>usr_quant5</th>
                            <th>usr_quant6</th>
                        </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>
{% endblock my_content %}